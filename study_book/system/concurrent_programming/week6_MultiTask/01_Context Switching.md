# 1. Context Switching

## 멀티태스킹의 정의
- N개의 프로세스에서 N개의 태스크가 진행되는 것은 과연 멀티태스킹인가?
- 임의의 시점에서 새로운 프로세스를 생성할 수 있고, 공평하게 실행될 수 있다.

## 컨텍스트 스위칭
- 이런 멀티태스킹을 위해 프로세스를 다른 프로세스로 변환하는 과정
- 이 때 컨텍스트는 레지스터 수준임.

## 공평하게 실행함
- 약한 공평성 (Weak Fairness)
  - 어떤 프로세스가 “계속 실행 가능한 상태(ready 상태)”로 남아 있다면, 언젠가는 CPU를 할당받아야 한다.
  - 프로세스가 실행 가능 상태 계속 유지되면, 결국은 실행된다.
- 강한 공평성 (Strong Fairness)
  - 어떤 프로세스가 “실행 가능 상태”에 무한히 반복해서 진입한다면, 언젠가는 CPU를 받아야 한다.
  - 실행 가능 상태에 한 번 진입하지 않고 계속 머물기보다, 반복적으로 실행 가능 상태에 들어올 경우에도 실행돼야 한다.

## 협조/비협조적 멀티태스킹
- 협조적 멀티태스크 (비선점적 멀티태스킹)
  - 각각의 프로세스가 자발적으로 컨텍스트 스위칭을 수행하는 경우
    - #FIXME : 협조적 멀티태스크는 명시적 Future와 유사한 개념인가?
  - 단점 : 앱 개발자가 슈퍼 개발자여야 함
- 비협조적 멀티태스크 (선점적 멀티태스킹)
  - 외부적인 작동에 따라 컨텍스트 스위치를 수행하는 경우
  - 단점 : 시스템 설계를 잘 해야 함



## 학부 때 지식과 연결 (Generated by GPT)
| 스케줄링 방식                                     | 협조성   | 약한 공평성 | 강한 공평성   | Starvation 위험 | 대표 알고리즘 / 환경       | 설명                           |
| ------------------------------------------- | ----- | ------ | -------- | ------------- | ------------------ | ---------------------------- |
| **FCFS**<br>(First-Come First-Served)       | ❌ 비협조 | ✅      | ❌        | ❌ 낮음          | 고전적 선입선출 큐         | 간단하지만 순서 외 공정성 없음            |
| **SJF**<br>(Shortest Job First)             | ❌ 비협조 | ❌      | ❌        | ✅ 높음          | 짧은 작업 우선           | 효율성은 좋지만 기아 발생 가능            |
| **SRTF**<br>(Shortest Remaining Time First) | ❌ 비협조 | ❌      | ❌        | ✅ 매우 높음       | 선점형 SJF            | 긴 작업은 거의 실행 불가               |
| **Priority Scheduling**                     | ❌ 비협조 | ❌      | ❌        | ✅ 높음          | 우선순위 기반            | 낮은 우선순위 task는 무시됨            |
| **Round Robin**                             | ❌ 비협조 | ✅      | ⚠️ 일부 보장 | ❌ 낮음          | 타임슬라이스 기반          | 약한 공평성의 대표                   |
| **MLFQ**<br>(Multi-Level Feedback Queue)    | ❌ 비협조 | ✅      | ✅        | ❌ 낮음          | 우선순위 + aging 반영    | 공평성과 반응성 양립 가능               |
| **Python `asyncio`**<br>(코루틴 기반)            | ✅ 협조  | ❌      | ❌        | ✅ 있음          | `await` 기반 task 전환 | `await`를 안 쓰면 다른 task 실행 안 됨 |
| **JavaScript Event Loop**                   | ✅ 협조  | ❌      | ❌        | ✅ 있음          | 브라우저 JS, Node.js   | 비동기 함수가 CPU 오래 쓰면 문제         |
| **MicroPython / RTOS (일부)**                 | ✅ 협조  | ❌      | ❌        | ✅ 있음          | `yield` 기반 스케줄링    | 실시간성보다 코드 간결성 중시             |

## 위의 SJF는 비선점 스케줄링인데, 협조적 멀티태스킹인가?
- 멀티태스킹과 스케줄링은 다른 기준이다.
🔍 SJF는 협조적일까?

|SJF 종류|선점 여부|협조/비협조|
|---------|--------|-----------|
|  비선점형 SJF	|❌ 선점 안 함|협조적처럼 보일 수 있지만 자동 yield 불가 → 협조적이라 보기 어려움|
|  선점형 SJF (SRTF)|	✅ 선점함|	명확하게 비협조적 (preemptive)|


🔎 왜 애매할까?
협조적/비협조적은 **멀티태스킹이 이루어지는 방식(스케줄링 전환 주체)**에 대한 구분입니다:

구분	전환 시점	제어 주체
협조적(Cooperative)	작업자가 직접 yield()	사용자 (개발자 또는 태스크)
비협조적(Preemptive)	타이머 등으로 강제 전환	OS 또는 런타임

그런데 SJF 자체는 "작업 시간 기준 우선순위"를 말할 뿐, 전환 방식(yield냐 타이머냐)은 스케줄러가 어떻게 구현했느냐에 따라 다릅니다.

📌 결론
SJF는 “스케줄링 정책”일 뿐,
“멀티태스킹 방식”인 협조/비협조와는 다른 기준입니다.

🔧 즉,

SJF는 협조적 멀티태스킹의 예시로 보긴 어렵고,
선점형 SJF(SRTF)는 비협조적 멀티태스킹의 예시로는 적절합니다.

